\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,parskip,custom}
\usepackage[margin=1in]{geometry}

\begin{document}

\title{MATH 239 --- Combinatorics}
\author{Kevin James}
\date{\vspace{-2ex}Spring 2014}
\maketitle\HRule

\section{Combinatorics}
{\bf Combinatorics} is discrete math dealing with `counting questions' and graph theory. For example:

``How many binary strings of length $n$ are there?'': $2^n$

``How many binary strings of length $n$ are there which do not contain the (continuous) substring `0101'?''

``How many ways can you make change for a dollar? (in Canada!)''

``How many $k$-element subsets are there in an $n$-element set?'': $n$ choose $k$ = $\frac{n!}{k!(n - k)!}$

``How many ways are there to order the numbers from 1 to $n$ with no constraints?'': $n!$

``Given 123 letters addressed to the 123 students in this class and 123 associated envelopes, how many ways are there to put one letter in each envelope such that nobody gets the right letter?'': $\approx \frac{123!}{e}$

``How many $n$-polyminos (tetris blocks) are there?'': $2 \function 1$, $3 \function 2$, $4 \function 5 | 7$

``How many prime numbers $p$ are there such that $p+2$ is also prime?'': infinite?

``How many rooted binary trees are there with $n$ vertices?''

``Can the vertices of a graph be colored by $n$ colors in such a way that every adjacent vertex is given a different color?''

``Can a graph be drawn such that no two edges are crossing?''

``Which graphs can be drawn in 3d-space to correspond to a fair symmetrical die?''

\subsection{Course Notation}
\begin{itemize}
\item $[n] = \{1, 2, 3, \dots, n\}$
\item $\mathbb{N} = \{1, 2, 3, \dots \}$
\item $A \cup B = \{ x \suchthat x \in A \text{ or } x \in B\}$
\item $A \cap B = \{ x \suchthat x \in A \text{ and } x \in B \}$
\item $|A \cup B| = |A| + |B| - |A \cap B|$
\item $A \times B = \{ (a,b) \suchthat a \in A \text{ and } b \in B \}$
\item $|A \times B| = |A| |B|$
\item $\mathbb{R} \times \mathbb{R}$ is the cartesian plane
\item $\mathbb{Z} \times \mathbb{Z}$ is the cartesian latice
\item $(a,b) \neq (b,a)$
\item ${n \choose k}$ is the number of $k$-element subsets of $n$.
\end{itemize}

\subsection{Functions}
A {\bf function} $f: A \function B$ is a subset of $A \times B$ such that each element of $A$ occurs as the first element of exactly one pair in the subset.

Given the set $\{ (dog, 4), (duck, 2), (cat, 3), (cow, 4) \}$, the mapping from first to second values in each tuple is a function.

A {\bf bijective} (\bijective) function is a `one-to-one' (no two elements of $A$ map to the same element of $B$) and `onto' (each element of $B$ is mapped to by some element of $A$) function.

A function $f$ is bijective if and only if it has an {\bf inverse}: a function $g: B \function A$ such that $f(g(x)) = x$ and $g(f(y)) = y$. If $A$ and $B$ are finite and a bijection $f: A \bijective B$ exists, then $|A| = |B|$.

\section{Combinatorial Proofs (Bijective Proofs)}
\begin{lemma}
There are $2^n$ subsets of $[n]$.
\end{lemma}

\begin{proof}
Let $X_n$ be the set of all subsets of $[n]$. Let $Y_n$ be the set of binary strings of length $[n]$. We know that $|Y_n| = 2^n$. For each set $S \in X_n$, let $f(S) = a_1, a_2, \dots, a_n$, where \[ a_i =
\begin{cases}
	1, & i \in S\\
	0, & \text{otherwise}.
\end{cases} \] For each string $a_1, a_2, \dots, a_n \in Y_n$, let $g(a_1, a_2, \dots, a_n) = \{ i \in [n]: a_1 = 1 \}$. Then, $g$ is an inverse function of $f$, so $f$ is a bijective function and thus $|X_n| = |Y_n| = 2^n$
\end{proof}

\begin{lemma}
${n \choose k} = {n \choose n - k}$ for all $0 \leq k \leq n$.
\end{lemma}

\begin{proof}
Let $x = \{ k\text{-element subsets of} [n] \}$. Let $y = \{ n-k\text{-element subsets of} [n] \}$. We know that $|y| = {n \choose n-k}$. For each set $S \in X$, let $f(S) = [n] \setminus S$ and let $g(S) = [n] \setminus S$. Then $f$ is a bijective function and thus $|x| = |y|$ and so ${n \choose k} = {n \choose n - k}$.
\end{proof}

\section{Permutations}
A {\bf permutation} of a set $S$ is $A \bijective A$.\@ this can be thought of as an ``ordering'' of the elements of $A$.

\begin{theorem}
There are $n!$ permutations of an $n$-element set.
\end{theorem}

For example, a permutation of $[5]$ could be $\sigma = (3,1,4,2,5)$.

\begin{lemma}
${n \choose k} = \frac{n!}{k!(n-k)!}$ for $0 \leq k \leq n$
\end{lemma}

\begin{proof}
Let $L$ be the set of all ordered $k$-tuples (selections) of distinct elements of $[n]$. We will compute $|L|$ in two different ways: since there are $n$ choices for the first element, $n-1$ for the next, et cetera, we have
\begin{align*}
|L| &= n(n-1)\dots(n-k+1)\\
&= \frac{n(n-1)\dots(n-k+1)(n-k)\dots2 \times 1}{(n-k)(n-k-1)\dots2 \times 1}\\
&= \frac{n!}{(n-k)!}
\end{align*}
Alternatively, we could choose an element of $L$ by first specifying the set of elements to be selected, then choosing their order. So $L = {n \choose k} k!$, where ${n \choose k}$ is the number of ways of choosing the set of $K$ things to be selected and $k!$ is the number of ways of putting the $k$ elements in order.

So ${n \choose k} k! = |L| = \frac{n!}{(n-k)!} \implies {n \choose k} = \frac{n!}{k!(n-k)!}$
\end{proof}

Incidentally, given this proof we can easily find ${n \choose k} \equiv {n \choose n-k}$.

\begin{theorem}[Binomial Theorem]
${(1 + x)}^n = \sum_{k=0}^n {n \choose k} x^k$
\end{theorem}

\begin{proof}
Consider $(1 + y_1)(1 + y_2)(1 + y_3) = 1 + y_1 + y_2 + y_3 + y_1y_2 + y_1y_3 + y_2y_3 + y_1y_2y_3$. We can associate these terms with $\{\}, \{1\}, \{2\}, \{3\}, \{1,2\}. \{1,3\}, \{2,3\}, \{1,2,3\}$. The statement ${3 \choose 2} = 3$ is equivalent to the fact that there exist $3$ $2$-element subsets in this list. If we now set $y_1 = y_2 = y_3 = x$, we get ${(1 + x)}^3 = 1 + 3x + 3x^2 + x^3$ or ${3 \choose 0} + {3 \choose 1}x + {3 \choose 2}x^2 + {3 \choose 3}x^3$.
\end{proof}

\begin{lemma}
$\displaystyle{n + k \choose n} = \sum_{i=0}^n {n + i - 1 \choose n - i}$
\end{lemma}

\begin{proof}
The first term is the number of $n$-element subsets of $[n+k]$ which must have a largest element $l$ equal to $n \leq l \leq n+k$. Now, the right-hand side could be expanded to ${n-1 \choose n-1} + {n \choose n-1} + {n+1 \choose n-1} + \cdots + {n + k -1 \choose n-1}$ which are respectively equivalent to the number of $n$-element subsets of $[n+k]$ with largest element $n, n+1, n+2, \dots n+k$.
\end{proof}

How many binary strings of length $n$ are there? How many subsets of $[n]$ are there of size $k$? How many permutatinos are there of a set of size $n$?

We can unify these three problems (and more) by `abstracting out' the idea of size or length. Let $S$ be a set. Suppose that each $\sigma \in S$ is assigned a non-negative integer `weight' $w(\sigma)$.

So if $S = \{\text{subsets of } [n]\}$ then manybe $w(\sigma) = (\text{size of }\sigma)$ for each $\sigma \in S$. Or, we could set $w(\sigma) =$ the sum of the elements of $\sigma$. If $S$ is the set of all binary strings, then maybe $w(\sigma) =$ the number of $1$'s in $\sigma$ or, alternatively, the length of $\sigma$.

\begin{example}
Given a set $S$ (of numbers, strings, sets, or whatever) and a weight function $w(\sigma)$ assigning a non-negative integer weight to each $\sigma$, how many elements of $S$ have weight $k$?
\end{example}

\begin{proof}
Given $S$ and $w$, define $\Phi_S(x)$ by $\Phi_S(x) = \displaystyle\sum_{\sigma \in S} x^{w(\sigma)}$. This is the {\bf generating series} for $S$ and $\sigma$.

For example: Assume $S = \{1, 3, 5\} \times \{2, 4, 6\}$. Let $w(a,b) = a+b$ for $a,b \in S$. The $S = \{ (1,2), (1,4), (1,6), (3,2), (3,4), (3,6), (5,2), (5,4), (5,6) \}$ and the weights are $[ 3, 5, 7, 5, 7, 9, 7, 9, 11 ]$.

Then we have $\Phi_S(x) = x^3 + 2x^5 + 3x^7 + 2x^9 + x^{11} = (x^1 + x^3 + x^5)(x^2 + x^4 + x^6)$. More generally, we have $\Phi_S(x) = \displaystyle\sum_{k \geq 0} (\text{number of elements of }S\text{ with weight }k)x^k$.
\end{proof}

\begin{example}
Let $S$ be the set of odd numbers beginning with $1$ and $w(\sigma) = \sigma, \forall \sigma \in S$.

Given
\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= x^{w(1)} + x^{w(3)} + x^{w(5)} + \dots\\
&= x^1 + x^3 + x^5 + \dots\\
&= x(1 + x^2 + x^4 + \dots)\\
&= x(\frac{1}{1 - x^2})\\
&= \frac{x}{1-x^2}
\end{align*}
\end{example}

\begin{theorem}
For a finite $S$ and any weight function on $S$, $\Phi_S(1) = |S|$.
\end{theorem}

\begin{proof}
$\Phi_S(1) = \displaystyle\sum_{\sigma \in S} 1^{w(\sigma)} = \sum_{\sigma \in S} 1 = |S|$.
\end{proof}

\begin{theorem}
$\deriv{\Phi_S(1)}{S} =$ the total weight of the elements of $S$.
\end{theorem}

\begin{theorem}
$\deriv{\Phi_S(1)}{\Phi_S(1)} =$ the average weight of an element of $S$.
\end{theorem}

\begin{example}
Let $S$ be the set of binary strings of a length less than or equal to $n$ and $w(\sigma)$ be the length of $\sigma$.

\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= \sigma_{k \geq 0} (\text{number of elements of }S\text{ with weight }k) x^k\\
&= \sum_{k \geq 0} (\text{number of binary strings of length }\leq n\text{ of weight }k) x^k\\
&= \sum_{k=0}^n 2^k x^k\\
&= \sum_{k=0}^n {(2x)}^k\\
&= 1 + 2x + {(2x)}^2 + \cdots + {(2x)}^n\\
&= \frac{1 - {(2x)}^{n+1}}{1 - 2x}
\end{align*}
and thus we have $\Phi_S(1) = \frac{1 - {(2x)}^{n+1}}{1 - 2x} = 2^{n+1} - 1$.

And so
\begin{align*}
\deriv{\Phi_S(x)}{S} &= \sum_{k=0}^n k 2^k x^{k-1}\\
\deriv{\Phi_S(1)}{S} &= \sum_{k=0}^n k 2^k\\
&= (n-1)2^{n+1} + 2
\end{align*}

The average length is thus \[ \deriv{\Phi_S(1)}{\Phi_S(1)} = \frac{(n-1)2^{n+1} + 2}{2^{n+1} - 1} = n - 1 + \frac{n+1}{2^{n+1} - 1} \approx n - 1 \]
\end{example}

\subsection{Formal Power Series}
A {\bf formal power series} is an expansion (i.e.\ generating function) of the form $\displaystyle\sum_{k \geq 0} a_k x^k$.

``A {\bf generating function} is a clothesline on which we hang a sequence of coefficients for display.'' -H. Wilf

We often treat formal power series as actual power series when using them. If $A(x) = \displaystyle\sum_{k\geq 0} a_k x^k, B(x) = \sum_{k\geq 0} b_k x^k$, then we define $(A+B)(x) = \displaystyle\sum_{k\geq 0} (a_k + b_k) x^k$. We can also multiply: with the same $A(x)$ and $B(x)$, we have $AB(x) = \displaystyle\sum_{k\geq 0} \bigg(\sum_{i=0}^k a_i b_{k-1}\bigg) x^k$.

We can also perform {\bf coefficient extraction}; $[x^k]A(x)$ is defined to be the coefficient of $x^k$ in $A(x)$.

We cnan easily solve linear equations whose variables are formal power series (FPS).

\begin{example}
Find a FPS $A(x)$ such that $(1 + x + x^2 + \dots)A(x) = 1-x$.

Let $A(x) = a_0 + a_1 x + a_2 x^2 + \dots$. We want to solve
\begin{align*}
(1 + x + x^2 + \dots)(a_0 + a_1 x + a_2 x^2 + \dots) &= 1 - x + (0x^2 + 0x^3 + 0x^4 + \dots)\\
a_o + (a_0 + a_1)x + (a_0 + a_1 + a_2)x^2 + \cdots &= 1 + (-1)x + 0x^2 + 0x^3 + \dots
\end{align*}

Equating coefficients gives
\begin{align*}
a_0 &= 1\\
a_0 + a_1 &= -1\\
a_0 + a_1 + a_2 &= 0\\
a_0 + a_1 + a_2 + a_3 &= 0\\
&\dots
\end{align*}
or more usefully
\begin{align*}
a_0 &= 1\\
a_1 &= -2\\
a_2 &= 1\\
a_3 &= 0\\
a_3 &= 0\\
&\dots
\end{align*}

So the solution is $A(x) = 1 - 2x + x^2$.

More simply, we have
\begin{align*}
\frac{1}{1-x} A(x) &= 1 - x\\
A(x) &= 1 -2x + x^2
\end{align*}
\end{example}

\end{document}
