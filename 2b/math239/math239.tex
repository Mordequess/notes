\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,hyperref,parskip,custom}
\usepackage[margin=.8in]{geometry}
\allowdisplaybreaks
\hypersetup{colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\begin{document}

\title{MATH 239 --- Combinatorics}
\author{Kevin James}
\date{\vspace{-2ex}Spring 2014}
\maketitle\HRule

\tableofcontents
\newpage

\section{Combinatorics}
{\bf Combinatorics} is discrete math dealing with `counting questions' and graph theory. For example:

``How many binary strings of length $n$ are there?'': $2^n$

``How many binary strings of length $n$ are there which do not contain the (continuous) substring `0101'?''

``How many ways can you make change for a dollar? (in Canada!)''

``How many $k$-element subsets are there in an $n$-element set?'': $n$ choose $k$ = $\frac{n!}{k!(n - k)!}$

``How many ways are there to order the numbers from 1 to $n$ with no constraints?'': $n!$

``Given 123 letters addressed to the 123 students in this class and 123 associated envelopes, how many ways are there to put one letter in each envelope such that nobody gets the right letter?'': $\approx \frac{123!}{e}$

``How many $n$-polynomials (tetris blocks) are there?'': $2 \function 1$, $3 \function 2$, $4 \function 5 | 7$

``How many prime numbers $p$ are there such that $p+2$ is also prime?'': infinite?

``How many rooted binary trees are there with $n$ vertices?''

``Can the vertices of a graph be colored by $n$ colors in such a way that every adjacent vertex is given a different color?''

``Can a graph be drawn such that no two edges are crossing?''

``Which graphs can be drawn in 3d-space to correspond to a fair symmetrical die?''

\subsection{Course Notation}
\begin{itemize}
\item $[n] = \{1, 2, 3, \dots, n\}$
\item $\mathbb{N} = \{1, 2, 3, \dots \}$
\item $A \cup B = \{ x \suchthat x \in A \text{ or } x \in B\}$
\item $A \cap B = \{ x \suchthat x \in A \text{ and } x \in B \}$
\item $|A \cup B| = |A| + |B| - |A \cap B|$
\item $A \times B = \{ (a,b) \suchthat a \in A \text{ and } b \in B \}$
\item $|A \times B| = |A| |B|$
\item $\mathbb{R} \times \mathbb{R}$ is the cartesian plane
\item $\mathbb{Z} \times \mathbb{Z}$ is the cartesian latice
\item $(a,b) \neq (b,a)$
\item ${n \choose k}$ is the number of $k$-element subsets of $n$.
\end{itemize}

\subsection{Functions}
A {\bf function} $f: A \function B$ is a subset of $A \times B$ such that each element of $A$ occurs as the first element of exactly one pair in the subset.

Given the set $\{ (dog, 4), (duck, 2), (cat, 3), (cow, 4) \}$, the mapping from first to second values in each tuple is a function.

A {\bf bijective} (\bijective) function is a `one-to-one' (no two elements of $A$ map to the same element of $B$) and `onto' (each element of $B$ is mapped to by some element of $A$) function.

A function $f$ is bijective if and only if it has an {\bf inverse}: a function $g: B \function A$ such that $f(g(x)) = x$ and $g(f(y)) = y$. If $A$ and $B$ are finite and a bijection $f: A \bijective B$ exists, then $|A| = |B|$.

\section{Combinatorial Proofs (Bijective Proofs)}
\begin{lemma}
There are $2^n$ subsets of $[n]$.
\end{lemma}

\begin{proof}
Let $X_n$ be the set of all subsets of $[n]$. Let $Y_n$ be the set of binary strings of length $[n]$. We know that $|Y_n| = 2^n$. For each set $S \in X_n$, let $f(S) = a_1, a_2, \dots, a_n$, where \[ a_i =
\begin{cases}
	1, & i \in S\\
	0, & \text{otherwise}.
\end{cases} \] For each string $a_1, a_2, \dots, a_n \in Y_n$, let $g(a_1, a_2, \dots, a_n) = \{ i \in [n]: a_1 = 1 \}$. Then, $g$ is an inverse function of $f$, so $f$ is a bijective function and thus $|X_n| = |Y_n| = 2^n$
\end{proof}

\begin{lemma}
${n \choose k} = {n \choose n - k}$ for all $0 \leq k \leq n$.
\end{lemma}

\begin{proof}
Let $x = \{ k\text{-element subsets of} [n] \}$. Let $y = \{ n-k\text{-element subsets of} [n] \}$. We know that $|y| = {n \choose n-k}$. For each set $S \in X$, let $f(S) = [n] \setminus S$ and let $g(S) = [n] \setminus S$. Then $f$ is a bijective function and thus $|x| = |y|$ and so ${n \choose k} = {n \choose n - k}$.
\end{proof}

\section{Permutations}
A {\bf permutation} of a set $S$ is $A \bijective A$.\@ this can be thought of as an ``ordering'' of the elements of $A$.

\begin{theorem}
There are $n!$ permutations of an $n$-element set.
\end{theorem}

For example, a permutation of $[5]$ could be $\sigma = (3,1,4,2,5)$.

\begin{lemma}
${n \choose k} = \frac{n!}{k!(n-k)!}$ for $0 \leq k \leq n$
\end{lemma}

\begin{proof}
Let $L$ be the set of all ordered $k$-tuples (selections) of distinct elements of $[n]$. We will compute $|L|$ in two different ways: since there are $n$ choices for the first element, $n-1$ for the next, et cetera, we have
\begin{align*}
|L| &= n(n-1)\dots(n-k+1)\\
&= \frac{n(n-1)\dots(n-k+1)(n-k)\dots2 \times 1}{(n-k)(n-k-1)\dots2 \times 1}\\
&= \frac{n!}{(n-k)!}
\end{align*}

Alternatively, we could choose an element of $L$ by first specifying the set of elements to be selected, then choosing their order. So $L = {n \choose k} k!$, where ${n \choose k}$ is the number of ways of choosing the set of $K$ things to be selected and $k!$ is the number of ways of putting the $k$ elements in order.

So ${n \choose k} k! = |L| = \frac{n!}{(n-k)!} \implies {n \choose k} = \frac{n!}{k!(n-k)!}$
\end{proof}

Incidentally, given this proof we can easily find ${n \choose k} \equiv {n \choose n-k}$.

\begin{theorem}[Binomial Theorem]
${(1 + x)}^n = \sum_{k=0}^n {n \choose k} x^k$
\end{theorem}

\begin{proof}
Consider $(1 + y_1)(1 + y_2)(1 + y_3) = 1 + y_1 + y_2 + y_3 + y_1y_2 + y_1y_3 + y_2y_3 + y_1y_2y_3$. We can associate these terms with $\{\}, \{1\}, \{2\}, \{3\}, \{1,2\}. \{1,3\}, \{2,3\}, \{1,2,3\}$. The statement ${3 \choose 2} = 3$ is equivalent to the fact that there exist $3$ $2$-element subsets in this list. If we now set $y_1 = y_2 = y_3 = x$, we get ${(1 + x)}^3 = 1 + 3x + 3x^2 + x^3$ or ${3 \choose 0} + {3 \choose 1}x + {3 \choose 2}x^2 + {3 \choose 3}x^3$.
\end{proof}

\begin{lemma}
$\displaystyle{n + k \choose n} = \sum_{i=0}^n {n + i - 1 \choose n - i}$
\end{lemma}

\begin{proof}
The first term is the number of $n$-element subsets of $[n+k]$ which must have a largest element $l$ equal to $n \leq l \leq n+k$. Now, the right-hand side could be expanded to ${n-1 \choose n-1} + {n \choose n-1} + {n+1 \choose n-1} + \cdots + {n + k -1 \choose n-1}$ which are respectively equivalent to the number of $n$-element subsets of $[n+k]$ with largest element $n, n+1, n+2, \dots n+k$.
\end{proof}

How many binary strings of length $n$ are there? How many subsets of $[n]$ are there of size $k$? How many permutatinos are there of a set of size $n$?

We can unify these three problems (and more) by `abstracting out' the idea of size or length. Let $S$ be a set. Suppose that each $\sigma \in S$ is assigned a non-negative integer `weight' $w(\sigma)$.

So if $S = \{\text{subsets of } [n]\}$ then manybe $w(\sigma) = (\text{size of }\sigma)$ for each $\sigma \in S$. Or, we could set $w(\sigma) =$ the sum of the elements of $\sigma$. If $S$ is the set of all binary strings, then maybe $w(\sigma) =$ the number of $1$'s in $\sigma$ or, alternatively, the length of $\sigma$.

\begin{example}
Given a set $S$ (of numbers, strings, sets, or whatever) and a weight function $w(\sigma)$ assigning a non-negative integer weight to each $\sigma$, how many elements of $S$ have weight $k$?
\end{example}

\begin{proof}
Given $S$ and $w$, define $\Phi_S(x)$ by $\Phi_S(x) = \displaystyle\sum_{\sigma \in S} x^{w(\sigma)}$. This is the {\bf generating series} for $S$ and $\sigma$.

For example: Assume $S = \{1, 3, 5\} \times \{2, 4, 6\}$. Let $w(a,b) = a+b$ for $a,b \in S$. The $S = \{ (1,2), (1,4), (1,6), (3,2), (3,4), (3,6), (5,2), (5,4), (5,6) \}$ and the weights are $[ 3, 5, 7, 5, 7, 9, 7, 9, 11 ]$.

Then we have $\Phi_S(x) = x^3 + 2x^5 + 3x^7 + 2x^9 + x^{11} = (x^1 + x^3 + x^5)(x^2 + x^4 + x^6)$. More generally, we have $\Phi_S(x) = \displaystyle\sum_{k \geq 0} (\text{number of elements of }S\text{ with weight }k)x^k$.
\end{proof}

\begin{example}
Let $S$ be the set of odd numbers beginning with $1$ and $w(\sigma) = \sigma, \forall \sigma \in S$.

Given
\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= x^{w(1)} + x^{w(3)} + x^{w(5)} + \dots\\
&= x^1 + x^3 + x^5 + \dots\\
&= x(1 + x^2 + x^4 + \dots)\\
&= x(\frac{1}{1 - x^2})\\
&= \frac{x}{1-x^2}
\end{align*}
\end{example}

\begin{theorem}
For a finite $S$ and any weight function on $S$, $\Phi_S(1) = |S|$.
\end{theorem}

\begin{proof}
$\Phi_S(1) = \displaystyle\sum_{\sigma \in S} 1^{w(\sigma)} = \sum_{\sigma \in S} 1 = |S|$.
\end{proof}

\begin{theorem}
$\deriv{\Phi_S(1)}{S} =$ the total weight of the elements of $S$.
\end{theorem}

\begin{theorem}
$\deriv{\Phi_S(1)}{\Phi_S(1)} =$ the average weight of an element of $S$.
\end{theorem}

\begin{example}
Let $S$ be the set of binary strings of a length less than or equal to $n$ and $w(\sigma)$ be the length of $\sigma$.

\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= \sigma_{k \geq 0} (\text{number of elements of }S\text{ with weight }k) x^k\\
&= \sum_{k \geq 0} (\text{number of binary strings of length }\leq n\text{ of weight }k) x^k\\
&= \sum_{k=0}^n 2^k x^k\\
&= \sum_{k=0}^n {(2x)}^k\\
&= 1 + 2x + {(2x)}^2 + \cdots + {(2x)}^n\\
&= \frac{1 - {(2x)}^{n+1}}{1 - 2x}
\end{align*}
and thus we have $\Phi_S(1) = \frac{1 - {(2x)}^{n+1}}{1 - 2x} = 2^{n+1} - 1$.

And so
\begin{align*}
\deriv{\Phi_S(x)}{S} &= \sum_{k=0}^n k 2^k x^{k-1}\\
\deriv{\Phi_S(1)}{S} &= \sum_{k=0}^n k 2^k\\
&= (n-1)2^{n+1} + 2
\end{align*}

The average length is thus \[ \deriv{\Phi_S(1)}{\Phi_S(1)} = \frac{(n-1)2^{n+1} + 2}{2^{n+1} - 1} = n - 1 + \frac{n+1}{2^{n+1} - 1} \approx n - 1 \]
\end{example}

\subsection{Formal Power Series}
A {\bf formal power series} is an expansion (i.e.\ generating function) of the form $\displaystyle\sum_{k \geq 0} a_k x^k$.

``A {\bf generating function} is a clothesline on which we hang a sequence of coefficients for display.'' -H. Wilf

We often treat formal power series as actual power series when using them. If $A(x) = \displaystyle\sum_{k\geq 0} a_k x^k, B(x) = \sum_{k\geq 0} b_k x^k$, then we define $(A+B)(x) = \displaystyle\sum_{k\geq 0} (a_k + b_k) x^k$. We can also multiply: with the same $A(x)$ and $B(x)$, we have $AB(x) = \displaystyle\sum_{k\geq 0} \bigg(\sum_{i=0}^k a_i b_{k-1}\bigg) x^k$.

We can also perform {\bf coefficient extraction}; $[x^k]A(x)$ is defined to be the coefficient of $x^k$ in $A(x)$.

We can easily solve linear equations whose variables are formal power series (FPS).

\begin{example}
Find a FPS $A(x)$ such that $(1 + x + x^2 + \dots)A(x) = 1-x$.

Let $A(x) = a_0 + a_1 x + a_2 x^2 + \dots$. We want to solve
\begin{align*}
(1 + x + x^2 + \dots)(a_0 + a_1 x + a_2 x^2 + \dots) &= 1 - x + (0x^2 + 0x^3 + 0x^4 + \dots)\\
a_o + (a_0 + a_1)x + (a_0 + a_1 + a_2)x^2 + \cdots &= 1 + (-1)x + 0x^2 + 0x^3 + \dots
\end{align*}

Equating coefficients gives
\begin{align*}
a_0 &= 1\\
a_0 + a_1 &= -1\\
a_0 + a_1 + a_2 &= 0\\
a_0 + a_1 + a_2 + a_3 &= 0\\
&\dots
\end{align*}
or more usefully
\begin{align*}
a_0 &= 1\\
a_1 &= -2\\
a_2 &= 1\\
a_3 &= 0\\
a_3 &= 0\\
&\dots
\end{align*}

So the solution is $A(x) = 1 - 2x + x^2$.

More simply, we have
\begin{align*}
\frac{1}{1-x} A(x) &= 1 - x\\
A(x) &= 1 -2x + x^2
\end{align*}
\end{example}

Given a power series $P(x)$, if $Q(x)$ is another power series such that $PQ(x) = 1$ then $Q(x)$ is an inverse of $P(x)$. We write $Q(x) = P^{-1}(x) = \frac{1}{P(x)}$.

\begin{lemma}
$P(x) = \displaystyle\sum_{k \geq 0} P_k x^k$ has an inverse if and only iff $p_0 \neq =$.
\end{lemma}

We can often write formal power series more concisely in terms of their inverses. This can be useful for simplifying a series, for example:
\begin{align*}
(1 + x + x^2 + \dots) B(x) &= 1-x\\
\frac{1}{1-x} B(x) &= 1 - x\\
B(x) &= {(1-x)}^2\\
&= 1 -2x  + x^2
\end{align*}

A common way to compute inverses is to use the formula for the sum of a geometric series \[ \sum_{k\geq 0} x^k = \frac{1}{1-x} \] We can `substitute' any formal power series $P(x)$ in place of $x$ in this formula if $P(x)$ has a constant term with a value of zero (e.g.\ has no constant terms).

\begin{example}
How many ways are there to eat $n$ pieces of fruit if you must eat
\begin{itemize}
\item at most five apples
\item at least three bananas
\item an even number of cherries
\end{itemize}

The solution is
\begin{align*}
f(x) &= [x^n] (1 + x + x^2 + x^3 + x^4 + x^5)(x^3 + x^4 + x^5 + \dots)(1 + x^2 + x^4 + \dots)\\
&= [x^n] \bigg(\frac{1-x^6}{1-x}\bigg)\bigg(\frac{x^3}{1-x}\bigg)\bigg(\frac{1}{1-x^2}\bigg)\\
&= [x^n] \bigg(\frac{x^3(1-x^6)}{{(1-x)}^2(1-x^2)}\bigg)
\end{align*}
\end{example}

Given a set $S$ and a weight function $w$ assigning a non-negative integer value to each $\sigma \in S$, we defined \[ \Phi_S (x) = \sum_{\sigma\in S} x^{w(\sigma)} = \sum_{k\geq 0} {\text{\# elements in }S \choose \text{ with weight }k} x^k \]

\begin{lemma}[sum lemma]
Given a set $S$ with a weight function $w$, if $A$ and $B$ are disjoint sets such that $A \cup B = S$, then $\Phi_S (x) = \Phi_A (x) + \Phi_B (x)$.
\end{lemma}

\begin{lemma}[product lemma]
Let $A$ and $B$ be sets with weight functions $\alpha$ and $\beta$. If $S = A \times B$ and a weight function $w$ on $S$ is defined by $w(a,b) = \alpha(a) + \beta(b) \cdot \forall a,b \in S$, then \[ \Phi_S (x) = \Phi_A (x) \Phi_B (x) \]
\end{lemma}

\begin{theorem}[power theory]
The power theory is given by \[ {(1-x)}^{-k} = \sum_{n\geq 0} {n + k - 1 \choose k - 1} x^n \] Equivalently, $[x^n]{(1-x)}^{-k} = {n+k-1 \choose k-1}$.
\end{theorem}

\begin{proof}
We have
\begin{align*}
[x^n]{(1-x)}^{-k} &= [x^n]{\bigg(\frac{1}{1-x}\bigg)}^k\\
&= [x^n](1+x+x^2+x^3+\dots)(1+x+x^2+x^3+\dots)\dots(1+x+x^2+x^3+\dots)
\end{align*}
which is equivalent to the number of solutions to $a_1 + a_2 + a_3 + \cdots + a_n = n$ where $a_1, a_2, a_3, \dots, a_k \geq 0$. We need to prove this.

{\bf Claim:} the number of solutions to $a_1 + a_2 + a_3 + \cdots + a_n = n$ where $a_1, a_2, a_3, \dots, a_k \geq 0$ is equal to ${n+k-1 \choose k-1}$.

Let $T = \{\text{solutions to the equation}\}$ and $S = \{\text{binary strings of length }n+k-1 \text{ having }k-1\text{ ones}\}$. Thus $|S| = {n+k-1 \choose k-1}$. We associate each solution $(a_1, a_2, \dots, a_n) \in T$ with the string \[ 000\dots 01000\dots 1\dots 1000\dots 0 \in S \] where each lenth of $0$'s is equal in leangth to $a_1, a_2, \dots, a_k$.

This mapping is clearlt invertible, so it is a bijection. Therefore $|S| = |T|$ as required.
\end{proof}

A {\bf composition} of an integer $n$ into $k$ parts is a $k$-tuple $(a_1,a_2,\dots a_k)$ such that $a_1 + a_2 + \cdots + a_k = n$ and $a_1, a_2, \dots, a_k \in \mathbb{N} \geq 1$. Special case: there is a single composition of zero.

\begin{theorem}
For $n,k \geq 1$, there are ${n-1 \choose k-1}$ compositions of $n$ into $k$ parts.
\end{theorem}

\begin{proof}
For each composition $(a_1, a_2, \dots, a_k)$ of $n$, $(a_1 -1, a_2 -1, \dots, a_k -1)$ is a ``composition'' of $n-k$, except with parts allowed to be zero. There are ${(n-k)+k-1 \choose k-1} = {n-1 \choose k-1}$ of these by the claim.
\end{proof}

\begin{theorem}
For $n\geq 1$, there are $2^{n-1}$ compositions of $n$.
\end{theorem}

\begin{proof}
Summing the previous answer over all $k$, we get \[ \sum_{k=1}^n {n-1 \choose k-1} = {n-1 \choose 0} + {n-1 \choose 1} + \cdots + {n-1 \choose n-1} = 2^{n-1} \]
\end{proof}

\section{Restricted Compositions}
Many problems ask us to count the number of compositions of $n$ subject to restrictions on both the size and number of the parts. We can solve these `all' with generating series and the sum/product lemmas.

\begin{example}
How many compositons of $n$ are there into 2, 3, or 4 parts, where the first part is at most $4$ and the rest of the parts are odd?

We have
\begin{align*}
[x^n]\bigg(&(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)\\
+ &(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)\\
+ &(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)\bigg)
\end{align*}
or more simply
\begin{align*}
[x^n]\bigg(&(x^1 + x^2 + x^3 + x^4)\bigg(\frac{x}{1-x} + {\bigg(\frac{x}{1-x}\bigg)}^2 + {\bigg(\frac{x}{1-x}\bigg)}^3\bigg)\bigg)\\
\end{align*}
\end{example}

\begin{example}
How many compositions of $n$ are there into $k$ parts where each part is $1$ or $2$?

The answer is
\begin{align*}
[x^n]{(x^1 + x^2)}^k &= [x^n]x^k{(1+x)}^k\\
&= [x^{n-k}] {(1+x)}^k\\
&= {k \choose n-k}
\end{align*}
\end{example}

\begin{example}
How many compositions of $n$ are there into parts of size $1$ or $2$?

By the previous example, the answer is \[ \sum_{k=0}^\infty {k \choose n-k} \] Alternatively, since the answer for $k$ parts is $[x^n] x^k{(1+x)}^k$, we know that the answer for any number of parts is
\begin{align*}
&\quad\ [x^n]\bigl(1 + x(1+x) + x^2{(1+x)}^2 + x^3{(1+x)}^3 + \dots \bigl)\\
&= [x^n]\bigl(1 + x(1+x) + {(x(1+x))}^2\bigl)\\
&= [x^n]\frac{1}{1-x(1+x)}\\
&= [x^n]\frac{1}{1-x-x^2}
\end{align*}
which is the $n$th Fibonacci number.
\end{example}

\begin{example}
How many compositions of $n$ are there into parts of an odd size?

\begin{align*}
&\quad\ [x^n]\bigg(1 + () + ()() + ()()() + \dots\bigg)\\
&= [x^n]\bigg(1 + (x^1 + x^3 + \dots) + {(x^1 + x^3 + \dots)}^2 + {(x^1 + x^3 + \dots)}^3 + \dots\bigg)\\
&= [x^n]\bigg(1 + \frac{x}{1-x^2} + {\frac{x}{1-x^2}}^2 + {\frac{x}{1-x^2}}^3 + \dots\bigg)\\
&= [x^n]\bigg(\frac{1}{1 - \frac{x}{1 - x^2}}\bigg)\\
&= [x^n]\bigg(\frac{1 - x^2}{1 - x - x^2}\bigg)\\
\end{align*}

If $A(x) = \frac{1-x^2}{1-x-x^2}$, we get \[ (1-x-x^2)A(x) = 1-x^2 \] which we can use to find $a = (1,1,1,2,3,5,8,13,21,\dots)$.
\end{example}

\begin{example}
Why is the number of compositions of $n$ parts of size 1 or 2 equal to the number of compositions of $n+1$ into parts of odd sizes? And why are both of these equal to the $n$th Fibonacci number?

We proved these facts algebraically; now we will do so combinatorially.

\begin{proof}
Let $S_n = \{\text{compositions of }n\text{ into parts of size 1 or 2}\}$. We will show that $|S_0| = |S_1| = 1$ and $|S_n| = |S_{n-1}| + |S_{n-2}|$ for $n\geq 2$.

The base case is obvious: there exists only one composition of one and one composition of zero by definition.

Let $S_n^\prime = \{\text{compositions in }S_n\text{ with last part }1\}$ and $S_n^{\prime\prime} = \{\text{compositions in }S_n\text{ with last part }2\}$. Then we have a bijection from $S_n^{prime}$ to $S_{n-1}$ and from $S-n^{\prime\prime}$ to $S_{n-2}$ by removing the last element in each composition.

For $(a_1, a_2, \cdots, a_k) \in S_n$, let $f(a_1, a_2, \cdots a_k) = (a_1, a_2, \cdots, a_{k-1})$. If $(a_1, \cdots, a_k) \in S_n^\prime$, then $a_k = 1$ so $f(a_1, a_2, \cdots, a_k) \in S_{n-1}$. Moreover, `adding back' a 1 to $f(a_1, \cdots, a_k)$ gives $(a_1, \cdots, a_k)$ so $f: S_n^\prime \to S_{n-1}$ is invertible and is thus a bijection, so $|S_n^\prime| = |S_{n-1}|$.

Similarly, if $(a_1, \cdots, a_k) \in S_n^{\prime\prime}$, then $a_k = 2$ so $f(a_1, \cdots, a_k) \in S_{n-2}$. Again, $f: S_n^{\prime\prime} \to S_{n-2}$ is invertible, so $|S_n^{\prime\prime}| = |S_{n-2}|$.

Thus $|S_n| = |S_n^\prime| + |S_n^{\prime\prime}| = |S_{n-1}| + |S_{n-2}|$, as required.
\end{proof}

\begin{proof}
Let $T_n = \{\text{compositions of }n\text{ into parts of odd sizes}\}$. Clearly $|T_1| = |T_2| = 1$; we will show that $|T_n| = |T_{n-1}| + |T_{n-2}|$ for $n\geq 3$.

Let $T_n^\prime = \{\text{compositions in }T_n\text{ with last part }1\}$ and $T_n^{\prime\prime} = \{\text{compositions in }T_n\text{ with last part }>1\}$.

The rest of this proof is the same as the above.
\end{proof}
\end{example}

\section{Binary Strings}
A binary string (e.g.\ $011010$) has length 6. We write $\ell(a)$ for the length of a binary string $a$. For nearly all counting problems we will do, $\ell(a)$ will be our weight function on the set of binary strings.

`Multiplication' of binary strings is concatentation, e.g.\ for $a = 101$ and $b = 0011$, $a^2b = aab = 1011010011$.

If $A$ and $B$ are sets of binary strings, then $AB := \{ab: a \in A, b \in B\}$. Note that we do not necessarily have $|AB| = |A||B|$, since this function is not required to produce unique outputs $ab$.

We write $A^2$ for $AA$, $A^3$ for $AAA$, etc, and $A^* = \{\varepsilon\} \cup A \cup A^2 \cup \dots = \displaystyle\bigcup_{i\geq 0} A^i$.

A {\bf substring} of a string $s$ is a string $b$ such that $s = abc$ for some $a$ and $c$. A {\bf block} of $s$ is a maximal substring of solely ones or zeros.

This decomposition of $s$ is unambiguous---that is, every string in $S$ can be uniquely expressed as a concatenation of ones and zeros.

This is not always the case: when we have $|AB| \neq |A| \times |B|$, some decompositions are ambiguous.

\begin{example}
Find $\Phi_S(x)$ where $S$ is the set of binary strings without $000$ as a substring.

We find the regular expression representing this set as $\{\varepsilon, 0, 00\}\{1, 10, 100\}*$. Then we have
\begin{align*}
\Phi_{S}(x) &= \Phi_{\{\varepsilon,0,00\}}(x) \Phi_{\{1,10,100\}*}(x)\\
&= \Phi_{\{\varepsilon,0,00\}}(x) \frac{1}{1 - \Phi_{\{1,10,100\}}(x)}\\
&= (x^0 + x^1 + x^2) \frac{1}{1 - (x^1 + x^2 + x^3)}\\
&= \frac{1 + x + x^2}{1 - x - x^2 - x^3}
\end{align*}
\end{example}

In general, $0*(11*00*)*1*$ and $1*(00*11*)*0*$ are unambiguous decompositions of the set of all binary strings that expose the `block' structure. We can often `refine' these to answer questions.

\begin{example}
Let $S$ be the set of all binary strings where an even-sized block of zeros is never followed by an odd-sized block of ones.

We can find $S = 1*\bigl(0(00)*11* \cup 00(00)*11(11)*\bigl)*0*$. Then we have
\begin{align*}
\Phi_S(x) &= \Phi_{1*}(x) \frac{1}{1 - \Phi_{\{\bigl(0(00)*11* \cup 00(00)*11(11)*\bigl)\}}} \Phi_{0*}(x)\\
&= \frac{1}{1-x} \frac{1}{1-(x\frac{1}{1-x^2} x\frac{1}{1-x} + x^2\frac{1}{1-x^2} x^2\frac{1}{1-x^2})} \frac{1}{1-x}\\
\end{align*}
\end{example}

\subsection{Recursive Decompositions}
Often, we can decompose a set of strings in terms of itself.

\begin{example}
Let $S$ be the set of all binary strings.

Each string in $S$ is either the empty string or a string in $S$ followed by a zero or a one. Thus $S = \{\varepsilon\} \cup S\{0,1\}$.

So, by our decomposition rules
\begin{align*}
\Phi_S(x) &= \Phi_{\{\varepsilon\}}(x) + \Phi_S(x)\Phi_{\{0,1\}}(x)\\
&= 1 + \Phi_S(x)\bigl(2x\bigl)\\
&= \frac{1}{1-2x}
\end{align*}
\end{example}

% Get someone's Monday notes

\subsubsection{Recurences with Repeated Roots}
\begin{theorem}
If $(a_n: n \geq 0)$ is a sequence defined by a recursion with characteristic polynomial $f(x) = {(x-\theta_1)}^{m_1} {(x-\theta_2)}^{m_2} \dots {(x-\theta_k)}^{m_k}$, then $a_n = p_1(n)\theta_1^n + p_2(n) \theta_2^n + \cdots + p_k(n) \theta_k^n$, for some polynomials $p_1(n), \dots p_k(n)$ where each $p_i$ has degree $< m_i$.
\end{theorem}

\end{document}
