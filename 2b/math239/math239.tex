\documentclass[12pt]{article}
\usepackage{amsmath,amssymb,hyperref,parskip,custom}
\usepackage[margin=.8in]{geometry}
\allowdisplaybreaks
\hypersetup{colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\begin{document}

\title{MATH 239 --- Combinatorics}
\author{Kevin James}
\date{\vspace{-2ex}Spring 2014}
\maketitle\HRule

\tableofcontents
\newpage

\section{Combinatorics}
{\bf Combinatorics} is discrete math dealing with `counting questions' and graph theory. For example:

``How many binary strings of length $n$ are there?'': $2^n$

``How many binary strings of length $n$ are there which do not contain the (continuous) substring `0101'?''

``How many ways can you make change for a dollar? (in Canada!)''

``How many $k$-element subsets are there in an $n$-element set?'': $n$ choose $k$ = $\frac{n!}{k!(n - k)!}$

``How many ways are there to order the numbers from 1 to $n$ with no constraints?'': $n!$

``Given 123 letters addressed to the 123 students in this class and 123 associated envelopes, how many ways are there to put one letter in each envelope such that nobody gets the right letter?'': $\approx \frac{123!}{e}$

``How many $n$-polynomials (tetris blocks) are there?'': $2 \function 1$, $3 \function 2$, $4 \function 5 | 7$

``How many prime numbers $p$ are there such that $p+2$ is also prime?'': infinite?

``How many rooted binary trees are there with $n$ vertices?''

``Can the vertices of a graph be colored by $n$ colors in such a way that every adjacent vertex is given a different color?''

``Can a graph be drawn such that no two edges are crossing?''

``Which graphs can be drawn in 3d-space to correspond to a fair symmetrical die?''

\subsection{Course Notation}
\begin{itemize}
\item $[n] = \{1, 2, 3, \dots, n\}$
\item $\mathbb{N} = \{1, 2, 3, \dots \}$
\item $A \cup B = \{ x \suchthat x \in A \text{ or } x \in B\}$
\item $A \cap B = \{ x \suchthat x \in A \text{ and } x \in B \}$
\item $|A \cup B| = |A| + |B| - |A \cap B|$
\item $A \times B = \{ (a,b) \suchthat a \in A \text{ and } b \in B \}$
\item $|A \times B| = |A| |B|$
\item $\mathbb{R} \times \mathbb{R}$ is the cartesian plane
\item $\mathbb{Z} \times \mathbb{Z}$ is the cartesian latice
\item $(a,b) \neq (b,a)$
\item ${n \choose k}$ is the number of $k$-element subsets of $n$.
\end{itemize}

\subsection{Functions}
A {\bf function} $f: A \function B$ is a subset of $A \times B$ such that each element of $A$ occurs as the first element of exactly one pair in the subset.

Given the set $\{ (dog, 4), (duck, 2), (cat, 3), (cow, 4) \}$, the mapping from first to second values in each tuple is a function.

A {\bf bijective} (\bijective) function is a `one-to-one' (no two elements of $A$ map to the same element of $B$) and `onto' (each element of $B$ is mapped to by some element of $A$) function.

A function $f$ is bijective if and only if it has an {\bf inverse}: a function $g: B \function A$ such that $f(g(x)) = x$ and $g(f(y)) = y$. If $A$ and $B$ are finite and a bijection $f: A \bijective B$ exists, then $|A| = |B|$.

\section{Combinatorial Proofs (Bijective Proofs)}
\begin{lemma}
There are $2^n$ subsets of $[n]$.
\end{lemma}

\begin{proof}
Let $X_n$ be the set of all subsets of $[n]$. Let $Y_n$ be the set of binary strings of length $[n]$. We know that $|Y_n| = 2^n$. For each set $S \in X_n$, let $f(S) = a_1, a_2, \dots, a_n$, where \[ a_i =
\begin{cases}
	1, & i \in S\\
	0, & \text{otherwise}.
\end{cases} \] For each string $a_1, a_2, \dots, a_n \in Y_n$, let $g(a_1, a_2, \dots, a_n) = \{ i \in [n]: a_1 = 1 \}$. Then, $g$ is an inverse function of $f$, so $f$ is a bijective function and thus $|X_n| = |Y_n| = 2^n$
\end{proof}

\begin{lemma}
${n \choose k} = {n \choose n - k}$ for all $0 \leq k \leq n$.
\end{lemma}

\begin{proof}
Let $x = \{ k\text{-element subsets of} [n] \}$. Let $y = \{ n-k\text{-element subsets of} [n] \}$. We know that $|y| = {n \choose n-k}$. For each set $S \in X$, let $f(S) = [n] \setminus S$ and let $g(S) = [n] \setminus S$. Then $f$ is a bijective function and thus $|x| = |y|$ and so ${n \choose k} = {n \choose n - k}$.
\end{proof}

\section{Permutations}
A {\bf permutation} of a set $S$ is $A \bijective A$.\@ this can be thought of as an ``ordering'' of the elements of $A$.

\begin{theorem}
There are $n!$ permutations of an $n$-element set.
\end{theorem}

For example, a permutation of $[5]$ could be $\sigma = (3,1,4,2,5)$.

\begin{lemma}
${n \choose k} = \frac{n!}{k!(n-k)!}$ for $0 \leq k \leq n$
\end{lemma}

\begin{proof}
Let $L$ be the set of all ordered $k$-tuples (selections) of distinct elements of $[n]$. We will compute $|L|$ in two different ways: since there are $n$ choices for the first element, $n-1$ for the next, et cetera, we have
\begin{align*}
|L| &= n(n-1)\dots(n-k+1)\\
&= \frac{n(n-1)\dots(n-k+1)(n-k)\dots2 \times 1}{(n-k)(n-k-1)\dots2 \times 1}\\
&= \frac{n!}{(n-k)!}
\end{align*}

Alternatively, we could choose an element of $L$ by first specifying the set of elements to be selected, then choosing their order. So $L = {n \choose k} k!$, where ${n \choose k}$ is the number of ways of choosing the set of $K$ things to be selected and $k!$ is the number of ways of putting the $k$ elements in order.

So ${n \choose k} k! = |L| = \frac{n!}{(n-k)!} \implies {n \choose k} = \frac{n!}{k!(n-k)!}$
\end{proof}

Incidentally, given this proof we can easily find ${n \choose k} \equiv {n \choose n-k}$.

\begin{theorem}[Binomial Theorem]
${(1 + x)}^n = \sum_{k=0}^n {n \choose k} x^k$
\end{theorem}

\begin{proof}
Consider $(1 + y_1)(1 + y_2)(1 + y_3) = 1 + y_1 + y_2 + y_3 + y_1y_2 + y_1y_3 + y_2y_3 + y_1y_2y_3$. We can associate these terms with $\{\}, \{1\}, \{2\}, \{3\}, \{1,2\}. \{1,3\}, \{2,3\}, \{1,2,3\}$. The statement ${3 \choose 2} = 3$ is equivalent to the fact that there exist $3$ $2$-element subsets in this list. If we now set $y_1 = y_2 = y_3 = x$, we get ${(1 + x)}^3 = 1 + 3x + 3x^2 + x^3$ or ${3 \choose 0} + {3 \choose 1}x + {3 \choose 2}x^2 + {3 \choose 3}x^3$.
\end{proof}

\begin{lemma}
$\displaystyle{n + k \choose n} = \sum_{i=0}^n {n + i - 1 \choose n - i}$
\end{lemma}

\begin{proof}
The first term is the number of $n$-element subsets of $[n+k]$ which must have a largest element $l$ equal to $n \leq l \leq n+k$. Now, the right-hand side could be expanded to ${n-1 \choose n-1} + {n \choose n-1} + {n+1 \choose n-1} + \cdots + {n + k -1 \choose n-1}$ which are respectively equivalent to the number of $n$-element subsets of $[n+k]$ with largest element $n, n+1, n+2, \dots n+k$.
\end{proof}

How many binary strings of length $n$ are there? How many subsets of $[n]$ are there of size $k$? How many permutatinos are there of a set of size $n$?

We can unify these three problems (and more) by `abstracting out' the idea of size or length. Let $S$ be a set. Suppose that each $\sigma \in S$ is assigned a non-negative integer `weight' $w(\sigma)$.

So if $S = \{\text{subsets of } [n]\}$ then manybe $w(\sigma) = (\text{size of }\sigma)$ for each $\sigma \in S$. Or, we could set $w(\sigma) =$ the sum of the elements of $\sigma$. If $S$ is the set of all binary strings, then maybe $w(\sigma) =$ the number of $1$'s in $\sigma$ or, alternatively, the length of $\sigma$.

\begin{example}
Given a set $S$ (of numbers, strings, sets, or whatever) and a weight function $w(\sigma)$ assigning a non-negative integer weight to each $\sigma$, how many elements of $S$ have weight $k$?
\end{example}

\begin{proof}
Given $S$ and $w$, define $\Phi_S(x)$ by $\Phi_S(x) = \displaystyle\sum_{\sigma \in S} x^{w(\sigma)}$. This is the {\bf generating series} for $S$ and $\sigma$.

For example: Assume $S = \{1, 3, 5\} \times \{2, 4, 6\}$. Let $w(a,b) = a+b$ for $a,b \in S$. The $S = \{ (1,2), (1,4), (1,6), (3,2), (3,4), (3,6), (5,2), (5,4), (5,6) \}$ and the weights are $[ 3, 5, 7, 5, 7, 9, 7, 9, 11 ]$.

Then we have $\Phi_S(x) = x^3 + 2x^5 + 3x^7 + 2x^9 + x^{11} = (x^1 + x^3 + x^5)(x^2 + x^4 + x^6)$. More generally, we have $\Phi_S(x) = \displaystyle\sum_{k \geq 0} (\text{number of elements of }S\text{ with weight }k)x^k$.
\end{proof}

\begin{example}
Let $S$ be the set of odd numbers beginning with $1$ and $w(\sigma) = \sigma, \forall \sigma \in S$.

Given
\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= x^{w(1)} + x^{w(3)} + x^{w(5)} + \dots\\
&= x^1 + x^3 + x^5 + \dots\\
&= x(1 + x^2 + x^4 + \dots)\\
&= x(\frac{1}{1 - x^2})\\
&= \frac{x}{1-x^2}
\end{align*}
\end{example}

\begin{theorem}
For a finite $S$ and any weight function on $S$, $\Phi_S(1) = |S|$.
\end{theorem}

\begin{proof}
$\Phi_S(1) = \displaystyle\sum_{\sigma \in S} 1^{w(\sigma)} = \sum_{\sigma \in S} 1 = |S|$.
\end{proof}

\begin{theorem}
$\deriv{\Phi_S(1)}{S} =$ the total weight of the elements of $S$.
\end{theorem}

\begin{theorem}
$\deriv{\Phi_S(1)}{\Phi_S(1)} =$ the average weight of an element of $S$.
\end{theorem}

\begin{example}
Let $S$ be the set of binary strings of a length less than or equal to $n$ and $w(\sigma)$ be the length of $\sigma$.

\begin{align*}
\Phi_S(x) &= \sum_{\sigma \in S} x^{w(\sigma)}\\
&= \sigma_{k \geq 0} (\text{number of elements of }S\text{ with weight }k) x^k\\
&= \sum_{k \geq 0} (\text{number of binary strings of length }\leq n\text{ of weight }k) x^k\\
&= \sum_{k=0}^n 2^k x^k\\
&= \sum_{k=0}^n {(2x)}^k\\
&= 1 + 2x + {(2x)}^2 + \cdots + {(2x)}^n\\
&= \frac{1 - {(2x)}^{n+1}}{1 - 2x}
\end{align*}
and thus we have $\Phi_S(1) = \frac{1 - {(2x)}^{n+1}}{1 - 2x} = 2^{n+1} - 1$.

And so
\begin{align*}
\deriv{\Phi_S(x)}{S} &= \sum_{k=0}^n k 2^k x^{k-1}\\
\deriv{\Phi_S(1)}{S} &= \sum_{k=0}^n k 2^k\\
&= (n-1)2^{n+1} + 2
\end{align*}

The average length is thus \[ \deriv{\Phi_S(1)}{\Phi_S(1)} = \frac{(n-1)2^{n+1} + 2}{2^{n+1} - 1} = n - 1 + \frac{n+1}{2^{n+1} - 1} \approx n - 1 \]
\end{example}

\subsection{Formal Power Series}
A {\bf formal power series} is an expansion (i.e.\ generating function) of the form $\displaystyle\sum_{k \geq 0} a_k x^k$.

``A {\bf generating function} is a clothesline on which we hang a sequence of coefficients for display.'' -H. Wilf

We often treat formal power series as actual power series when using them. If $A(x) = \displaystyle\sum_{k\geq 0} a_k x^k, B(x) = \sum_{k\geq 0} b_k x^k$, then we define $(A+B)(x) = \displaystyle\sum_{k\geq 0} (a_k + b_k) x^k$. We can also multiply: with the same $A(x)$ and $B(x)$, we have $AB(x) = \displaystyle\sum_{k\geq 0} \bigg(\sum_{i=0}^k a_i b_{k-1}\bigg) x^k$.

We can also perform {\bf coefficient extraction}; $[x^k]A(x)$ is defined to be the coefficient of $x^k$ in $A(x)$.

We can easily solve linear equations whose variables are formal power series (FPS).

\begin{example}
Find a FPS $A(x)$ such that $(1 + x + x^2 + \dots)A(x) = 1-x$.

Let $A(x) = a_0 + a_1 x + a_2 x^2 + \dots$. We want to solve
\begin{align*}
(1 + x + x^2 + \dots)(a_0 + a_1 x + a_2 x^2 + \dots) &= 1 - x + (0x^2 + 0x^3 + 0x^4 + \dots)\\
a_o + (a_0 + a_1)x + (a_0 + a_1 + a_2)x^2 + \cdots &= 1 + (-1)x + 0x^2 + 0x^3 + \dots
\end{align*}

Equating coefficients gives
\begin{align*}
a_0 &= 1\\
a_0 + a_1 &= -1\\
a_0 + a_1 + a_2 &= 0\\
a_0 + a_1 + a_2 + a_3 &= 0\\
&\dots
\end{align*}
or more usefully
\begin{align*}
a_0 &= 1\\
a_1 &= -2\\
a_2 &= 1\\
a_3 &= 0\\
a_3 &= 0\\
&\dots
\end{align*}

So the solution is $A(x) = 1 - 2x + x^2$.

More simply, we have
\begin{align*}
\frac{1}{1-x} A(x) &= 1 - x\\
A(x) &= 1 -2x + x^2
\end{align*}
\end{example}

Given a power series $P(x)$, if $Q(x)$ is another power series such that $PQ(x) = 1$ then $Q(x)$ is an inverse of $P(x)$. We write $Q(x) = P^{-1}(x) = \frac{1}{P(x)}$.

\begin{lemma}
$P(x) = \displaystyle\sum_{k \geq 0} P_k x^k$ has an inverse if and only iff $p_0 \neq =$.
\end{lemma}

We can often write formal power series more concisely in terms of their inverses. This can be useful for simplifying a series, for example:
\begin{align*}
(1 + x + x^2 + \dots) B(x) &= 1-x\\
\frac{1}{1-x} B(x) &= 1 - x\\
B(x) &= {(1-x)}^2\\
&= 1 -2x  + x^2
\end{align*}

A common way to compute inverses is to use the formula for the sum of a geometric series \[ \sum_{k\geq 0} x^k = \frac{1}{1-x} \] We can `substitute' any formal power series $P(x)$ in place of $x$ in this formula if $P(x)$ has a constant term with a value of zero (e.g.\ has no constant terms).

\begin{example}
How many ways are there to eat $n$ pieces of fruit if you must eat
\begin{itemize}
\item at most five apples
\item at least three bananas
\item an even number of cherries
\end{itemize}

The solution is
\begin{align*}
f(x) &= [x^n] (1 + x + x^2 + x^3 + x^4 + x^5)(x^3 + x^4 + x^5 + \dots)(1 + x^2 + x^4 + \dots)\\
&= [x^n] \bigg(\frac{1-x^6}{1-x}\bigg)\bigg(\frac{x^3}{1-x}\bigg)\bigg(\frac{1}{1-x^2}\bigg)\\
&= [x^n] \bigg(\frac{x^3(1-x^6)}{{(1-x)}^2(1-x^2)}\bigg)
\end{align*}
\end{example}

Given a set $S$ and a weight function $w$ assigning a non-negative integer value to each $\sigma \in S$, we defined \[ \Phi_S (x) = \sum_{\sigma\in S} x^{w(\sigma)} = \sum_{k\geq 0} {\text{\# elements in }S \choose \text{ with weight }k} x^k \]

\begin{lemma}[sum lemma]
Given a set $S$ with a weight function $w$, if $A$ and $B$ are disjoint sets such that $A \cup B = S$, then $\Phi_S (x) = \Phi_A (x) + \Phi_B (x)$.
\end{lemma}

\begin{lemma}[product lemma]
Let $A$ and $B$ be sets with weight functions $\alpha$ and $\beta$. If $S = A \times B$ and a weight function $w$ on $S$ is defined by $w(a,b) = \alpha(a) + \beta(b) \cdot \forall a,b \in S$, then \[ \Phi_S (x) = \Phi_A (x) \Phi_B (x) \]
\end{lemma}

\begin{theorem}[power theory]
The power theory is given by \[ {(1-x)}^{-k} = \sum_{n\geq 0} {n + k - 1 \choose k - 1} x^n \] Equivalently, $[x^n]{(1-x)}^{-k} = {n+k-1 \choose k-1}$.
\end{theorem}

\begin{proof}
We have
\begin{align*}
[x^n]{(1-x)}^{-k} &= [x^n]{\bigg(\frac{1}{1-x}\bigg)}^k\\
&= [x^n](1+x+x^2+x^3+\dots)(1+x+x^2+x^3+\dots)\dots(1+x+x^2+x^3+\dots)
\end{align*}
which is equivalent to the number of solutions to $a_1 + a_2 + a_3 + \cdots + a_n = n$ where $a_1, a_2, a_3, \dots, a_k \geq 0$. We need to prove this.

{\bf Claim:} the number of solutions to $a_1 + a_2 + a_3 + \cdots + a_n = n$ where $a_1, a_2, a_3, \dots, a_k \geq 0$ is equal to ${n+k-1 \choose k-1}$.

Let $T = \{\text{solutions to the equation}\}$ and $S = \{\text{binary strings of length }n+k-1 \text{ having }k-1\text{ ones}\}$. Thus $|S| = {n+k-1 \choose k-1}$. We associate each solution $(a_1, a_2, \dots, a_n) \in T$ with the string \[ 000\dots 01000\dots 1\dots 1000\dots 0 \in S \] where each lenth of $0$'s is equal in leangth to $a_1, a_2, \dots, a_k$.

This mapping is clearlt invertible, so it is a bijection. Therefore $|S| = |T|$ as required.
\end{proof}

A {\bf composition} of an integer $n$ into $k$ parts is a $k$-tuple $(a_1,a_2,\dots a_k)$ such that $a_1 + a_2 + \cdots + a_k = n$ and $a_1, a_2, \dots, a_k \in \mathbb{N} \geq 1$. Special case: there is a single composition of zero.

\begin{theorem}
For $n,k \geq 1$, there are ${n-1 \choose k-1}$ compositions of $n$ into $k$ parts.
\end{theorem}

\begin{proof}
For each composition $(a_1, a_2, \dots, a_k)$ of $n$, $(a_1 -1, a_2 -1, \dots, a_k -1)$ is a ``composition'' of $n-k$, except with parts allowed to be zero. There are ${(n-k)+k-1 \choose k-1} = {n-1 \choose k-1}$ of these by the claim.
\end{proof}

\begin{theorem}
For $n\geq 1$, there are $2^{n-1}$ compositions of $n$.
\end{theorem}

\begin{proof}
Summing the previous answer over all $k$, we get \[ \sum_{k=1}^n {n-1 \choose k-1} = {n-1 \choose 0} + {n-1 \choose 1} + \cdots + {n-1 \choose n-1} = 2^{n-1} \]
\end{proof}

\section{Restricted Compositions}
Many problems ask us to count the number of compositions of $n$ subject to restrictions on both the size and number of the parts. We can solve these `all' with generating series and the sum/product lemmas.

\begin{example}
How many compositons of $n$ are there into 2, 3, or 4 parts, where the first part is at most $4$ and the rest of the parts are odd?

We have
\begin{align*}
[x^n]\bigg(&(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)\\
+ &(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)\\
+ &(x^1 + x^2 + x^3 + x^4)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)(x^1 + x^3 + \dots)\bigg)
\end{align*}
or more simply
\begin{align*}
[x^n]\bigg(&(x^1 + x^2 + x^3 + x^4)\bigg(\frac{x}{1-x} + {\bigg(\frac{x}{1-x}\bigg)}^2 + {\bigg(\frac{x}{1-x}\bigg)}^3\bigg)\bigg)\\
\end{align*}
\end{example}

\begin{example}
How many compositions of $n$ are there into $k$ parts where each part is $1$ or $2$?

The answer is
\begin{align*}
[x^n]{(x^1 + x^2)}^k &= [x^n]x^k{(1+x)}^k\\
&= [x^{n-k}] {(1+x)}^k\\
&= {k \choose n-k}
\end{align*}
\end{example}

\begin{example}
How many compositions of $n$ are there into parts of size $1$ or $2$?

By the previous example, the answer is \[ \sum_{k=0}^\infty {k \choose n-k} \] Alternatively, since the answer for $k$ parts is $[x^n] x^k{(1+x)}^k$, we know that the answer for any number of parts is
\begin{align*}
&\quad\ [x^n]\bigl(1 + x(1+x) + x^2{(1+x)}^2 + x^3{(1+x)}^3 + \dots \bigl)\\
&= [x^n]\bigl(1 + x(1+x) + {(x(1+x))}^2\bigl)\\
&= [x^n]\frac{1}{1-x(1+x)}\\
&= [x^n]\frac{1}{1-x-x^2}
\end{align*}
which is the $n$th Fibonacci number.
\end{example}

\begin{example}
How many compositions of $n$ are there into parts of an odd size?

\begin{align*}
&\quad\ [x^n]\bigg(1 + () + ()() + ()()() + \dots\bigg)\\
&= [x^n]\bigg(1 + (x^1 + x^3 + \dots) + {(x^1 + x^3 + \dots)}^2 + {(x^1 + x^3 + \dots)}^3 + \dots\bigg)\\
&= [x^n]\bigg(1 + \frac{x}{1-x^2} + {\frac{x}{1-x^2}}^2 + {\frac{x}{1-x^2}}^3 + \dots\bigg)\\
&= [x^n]\bigg(\frac{1}{1 - \frac{x}{1 - x^2}}\bigg)\\
&= [x^n]\bigg(\frac{1 - x^2}{1 - x - x^2}\bigg)\\
\end{align*}

If $A(x) = \frac{1-x^2}{1-x-x^2}$, we get \[ (1-x-x^2)A(x) = 1-x^2 \] which we can use to find $a = (1,1,1,2,3,5,8,13,21,\dots)$.
\end{example}

\begin{example}
Why is the number of compositions of $n$ parts of size 1 or 2 equal to the number of compositions of $n+1$ into parts of odd sizes? And why are both of these equal to the $n$th Fibonacci number?

We proved these facts algebraically; now we will do so combinatorially.

\begin{proof}
Let $S_n = \{\text{compositions of }n\text{ into parts of size 1 or 2}\}$. We will show that $|S_0| = |S_1| = 1$ and $|S_n| = |S_{n-1}| + |S_{n-2}|$ for $n\geq 2$.

The base case is obvious: there exists only one composition of one and one composition of zero by definition.

Let $S_n^\prime = \{\text{compositions in }S_n\text{ with last part }1\}$ and $S_n^{\prime\prime} = \{\text{compositions in }S_n\text{ with last part }2\}$. Then we have a bijection from $S_n^{prime}$ to $S_{n-1}$ and from $S-n^{\prime\prime}$ to $S_{n-2}$ by removing the last element in each composition.

For $(a_1, a_2, \ldots, a_k) \in S_n$, let $f(a_1, a_2, \cdots a_k) = (a_1, a_2, \ldots, a_{k-1})$. If $(a_1, \ldots, a_k) \in S_n^\prime$, then $a_k = 1$ so $f(a_1, a_2, \ldots, a_k) \in S_{n-1}$. Moreover, `adding back' a 1 to $f(a_1, \ldots, a_k)$ gives $(a_1, \ldots, a_k)$ so $f: S_n^\prime \to S_{n-1}$ is invertible and is thus a bijection, so $|S_n^\prime| = |S_{n-1}|$.

Similarly, if $(a_1, \ldots, a_k) \in S_n^{\prime\prime}$, then $a_k = 2$ so $f(a_1, \ldots, a_k) \in S_{n-2}$. Again, $f: S_n^{\prime\prime} \to S_{n-2}$ is invertible, so $|S_n^{\prime\prime}| = |S_{n-2}|$.

Thus $|S_n| = |S_n^\prime| + |S_n^{\prime\prime}| = |S_{n-1}| + |S_{n-2}|$, as required.
\end{proof}

\begin{proof}
Let $T_n = \{\text{compositions of }n\text{ into parts of odd sizes}\}$. Clearly $|T_1| = |T_2| = 1$; we will show that $|T_n| = |T_{n-1}| + |T_{n-2}|$ for $n\geq 3$.

Let $T_n^\prime = \{\text{compositions in }T_n\text{ with last part }1\}$ and $T_n^{\prime\prime} = \{\text{compositions in }T_n\text{ with last part }>1\}$.

The rest of this proof is the same as the above.
\end{proof}
\end{example}

\section{Binary Strings}
A binary string (e.g.\ $011010$) has length 6. We write $\ell(a)$ for the length of a binary string $a$. For nearly all counting problems we will do, $\ell(a)$ will be our weight function on the set of binary strings.

`Multiplication' of binary strings is concatentation, e.g.\ for $a = 101$ and $b = 0011$, $a^2b = aab = 1011010011$.

If $A$ and $B$ are sets of binary strings, then $AB := \{ab: a \in A, b \in B\}$. Note that we do not necessarily have $|AB| = |A||B|$, since this function is not required to produce unique outputs $ab$.

We write $A^2$ for $AA$, $A^3$ for $AAA$, etc, and $A^* = \{\varepsilon\} \cup A \cup A^2 \cup \dots = \displaystyle\bigcup_{i\geq 0} A^i$.

A {\bf substring} of a string $s$ is a string $b$ such that $s = abc$ for some $a$ and $c$. A {\bf block} of $s$ is a maximal substring of solely ones or zeros.

This decomposition of $s$ is unambiguous---that is, every string in $S$ can be uniquely expressed as a concatenation of ones and zeros.

This is not always the case: when we have $|AB| \neq |A| \times |B|$, some decompositions are ambiguous.

\begin{example}
Find $\Phi_S(x)$ where $S$ is the set of binary strings without $000$ as a substring.

We find the regular expression representing this set as $\{\varepsilon, 0, 00\}\{1, 10, 100\}*$. Then we have
\begin{align*}
\Phi_{S}(x) &= \Phi_{\{\varepsilon,0,00\}}(x) \Phi_{\{1,10,100\}*}(x)\\
&= \Phi_{\{\varepsilon,0,00\}}(x) \frac{1}{1 - \Phi_{\{1,10,100\}}(x)}\\
&= (x^0 + x^1 + x^2) \frac{1}{1 - (x^1 + x^2 + x^3)}\\
&= \frac{1 + x + x^2}{1 - x - x^2 - x^3}
\end{align*}
\end{example}

In general, $0*(11*00*)*1*$ and $1*(00*11*)*0*$ are unambiguous decompositions of the set of all binary strings that expose the `block' structure. We can often `refine' these to answer questions.

\begin{example}
Let $S$ be the set of all binary strings where an even-sized block of zeros is never followed by an odd-sized block of ones.

We can find $S = 1*\bigl(0(00)*11* \cup 00(00)*11(11)*\bigl)*0*$. Then we have
\begin{align*}
\Phi_S(x) &= \Phi_{1*}(x) \frac{1}{1 - \Phi_{\{\bigl(0(00)*11* \cup 00(00)*11(11)*\bigl)\}}} \Phi_{0*}(x)\\
&= \frac{1}{1-x} \frac{1}{1-(x\frac{1}{1-x^2} x\frac{1}{1-x} + x^2\frac{1}{1-x^2} x^2\frac{1}{1-x^2})} \frac{1}{1-x}\\
\end{align*}
\end{example}

\subsection{Recursive Decompositions}
Often, we can decompose a set of strings in terms of itself.

\begin{example}
Let $S$ be the set of all binary strings.

Each string in $S$ is either the empty string or a string in $S$ followed by a zero or a one. Thus $S = \{\varepsilon\} \cup S\{0,1\}$.

So, by our decomposition rules
\begin{align*}
\Phi_S(x) &= \Phi_{\{\varepsilon\}}(x) + \Phi_S(x)\Phi_{\{0,1\}}(x)\\
&= 1 + \Phi_S(x)\bigl(2x\bigl)\\
&= \frac{1}{1-2x}
\end{align*}
\end{example}

% Get someone's Monday notes

\subsection{Recurences with Repeated Roots}
\begin{theorem}
If $(a_n: n \geq 0)$ is a sequence defined by a recursion with characteristic polynomial $f(x) = {(x-\theta_1)}^{m_1} {(x-\theta_2)}^{m_2} \dots {(x-\theta_k)}^{m_k}$, then $a_n = p_1(n)\theta_1^n + p_2(n) \theta_2^n + \cdots + p_k(n) \theta_k^n$, for some polynomials $p_1(n), \dots p_k(n)$ where each $p_i$ has degree $< m_i$.
\end{theorem}

\section{Graph Theory}
A {\bf graph} is a pair $(V,E)$ where $V$ is a finaite set of `vertices' and $E$ is a finite set of unordered pairs of distinct elements of $V$ (two-element subset of $V$) called `edges'.

If two vertices are connected by an edge, they are considered adjacent. Otherwise, they are non-adjacent. The edge between two vertices is incident to each of those vertices and the vertices adjacent to another vertex are its neighbours.

We say that two graphs are isomorphic (``equivalent'') if they can be drawn identically. More rigorously, we can prove that if there exists some function $f$ such that $f$ is a bijection between the vertices of each of two graphs and performing this bijection also causes the set of edges to become equivalent, then those graphs are isomorphic. This bijection must maintain adjacency, etc.

Foramlly, we have: $G_1$ and $G_2$ are isomorphic if there exists a bijection $\varphi : V_1 \to V_2$ such that $x$ and $y$ are adjacent in $G-1$ if and only if $\varphi(x)$ and $\varphi(y)$ are adjacent in $G_2$.

Note that there is a differnce between being isomorphic and being ``the same graph''. If two graph drawings have the same vertex labels and edge connections, not only are they isomorphic (all graphs are isomorphic to themselves), they are also equivalent (i.e.\ they are the same graph).

\begin{theorem}[The Handshake Theorem]
$\displaystyle\sum_{v\in V} \deg(v) = 2|E|$
\end{theorem}

Corollary: every graph has an even number of vertices of odd degree.

A graph is {\bf regular} if all vertices have the same degree. It is $d$-regular if every vertex has degree $d$. A graph whose vertex set $V$ has a partition $(A,B)$ such that every edge is incident with a vertex $A$ and a vertex in $B$ is said to be a {\bf bipartite} graph. $(A,B)$ is a {\bf bipartition} of $G$.

We define a {\bf cycle} as a graph $G$ with vertex set $\{v_1, v_2, \dots, v_n\}$ and edge set $\{v_1v_2, v_2v_3, \dots, v_n v_1\}$.

\begin{lemma}
A cycle $C$ is bipartite if and only if the number of vertices is even.
\end{lemma}

\begin{proof}
If $n$ is even, $(\{v_1, v_3, \dots, v_{n-1}\}, \{v_2, v_4, \dots, v_n\})$ is a bipartition. Thus $C$ is bipartite.

If $n$ is odd, we let $(A,B)$ be a bipartition where $v_1 \in A$. Since $v_2$ is adjacent to $v_1$, $v_2$ must be in $B$. Similarly, $v_3$ is in $A$. By an inductive argument, $v_i \in A$ if and only if $i$ is odd. So $v_n \in A$, but since $v_1$ we have $v_1 v_n$ is an edge between two vertices in $A$. Thus, we have a contradiction and $n$ cannot be odd.
\end{proof}

A graph in which all vertices are connected to each other is a {\bf complete} graph (also called a {\bf clique}). A complete graph $K_n$ has vertex set $\{v_1, v_2, \dots, v_n\}$ and edge set $\{v_i v_j : 1 \leq i \leq j \leq n\}$. $K_n$ has $n$ vertices and ${n \choose 2}$ edges. Only $K_2$ is a bipartite, all other complete graphs are not.

\begin{lemma}
Every graph on two or more vertices has two vertices of the same degree.
\end{lemma}

A {\bf complete bipartite} graph is a graph $K_{mn}$ with vertex set $\{u_1, u_2, \dots u_m, v_1, v_2, \dots v_n\}$ and edge set $E = \{ u_i v_j : 1 \leq i \leq m, 1 \leq j \leq n \}$. This graph is regular if and only if $m = n$.

An {\bf n-cube} is a graph with a vector set of the binary string of length $n$ such that two vertices are adjacent if and only if the differ in exactly one position. By definition, we know that an n-cube is bipartite. Each vertex of an $n$-cube has degree $n$. By the handshake theorem $|E| = n2^{n-1}$.

The n-cube can be recursively constructed from the $(n-1)$-cube by taking two copies and joining the pairs of corresponding vertices.

A {\bf subgraph} of $G = (V,E)$ is a graph $G^\prime = (v^\prime, E^\prime)$ where $V^\prime \in V$ and $E^\prime \in E$.

A {\bf walk} in a graph is a seqeunce which alternates between vertices and edges in such a way that each edge is incident to the vertices preceeding and following it. A walk must begin and end with vertices and is defined to have a length equal to the number of edges. If the first and last vertex in the walk are the same, the walk is considered {\bf closed}. Note that a walk can pass through a vertex any number of times, whether or not it is closed.

A {\bf path} is a walk with no repeated vertices. A closed walk with no repeated vertices (except the first and last) is a {\bf cycle}.

\begin{lemma}
\label{walkToPath}
If there is a walk between two vertices $u$ and $v$ in a graph $G$, then there is a path between $u$ and $v$ in $G$.
\end{lemma}

\begin{proof}
Let $u= v_0, v_1, v_2, \dots, v_k = v$ be a {\bf shortest} walk between $u$ and $v$ (use as few edges as possible). If this walk is not a path, then $v_i = v_j$ for some $0 \leq i \leq j \leq k$. But then $v_0, v_1, \dots, v_i, v_{j+1}, \dots v_k$ is a shorter walk---which is a contradiction.
\end{proof}

\begin{lemma}
\label{connectedPaths}
If $u,v,w$ are vertices of $G$ and there is a path from $u$ to $v$ and a path from $v$ to $w$, then thre is a path from $u$ to $w$.
\end{lemma}

\begin{proof}
Putting the two paths together, we get a walk (not necessarily a path) from $u$ to $w$. By lemma~\ref{walkToPath}, there is a path from $u$ to $w$.
\end{proof}

\begin{lemma}
If every vertex in $G$ has degree $d \geq 2$, then $G$ has a cycle.
\end{lemma}

\begin{proof}
Let $v_0, v_1, v_2, \dots v_k$ be a longest path in $G$. Since the path is longest, each number of $v_k$ is in the path and since $\deg(v_k) \geq 2$, $v_k$ has a neighbour $v_i \neq v_{k-1}$. Now $v_i, v_{i+1}, \dots, v_k, v_i$ is a cycle.
\end{proof}

\begin{theorem}[Dirac]
If $G$ is a graph with $n \geq 3$ vertices where every vertex has degree $d \geq \frac{n}{2}$, then $G$ has a cycle containing every vertex (a {\bf Hamiltonian Cycle}).
\end{theorem}

\begin{proof}
Let $P = (v_0, v_1, \dots v_k)$ be a longest path of $G$. We claim that there is a cycle $C$ with vertex set $\{v_0, v_1, \dots v_k\}$ and that every vertex is in $C$. We know that each of $v_0, v_k$ has $\geq \frac{n}{2}$ neighbours; by maximality of $P$, each such neighbour is in $P$.

Now let $I$ be the set of vertices in $P$ adjacent to $v_0$ and $J$ be the vertices in $P$ that are one to the right of a neighbour of $v_k$.
\end{proof}

\subsection{Connectivity}
A graph $G$ is {\bf connected} if, for every pair of vertices $u,v$ in $G$, there is a path (or walk) from $u$ to $v$. Complete graphs, complete bipartite graphs with non-empty sides, graphs with a hamiltonian cycle, and n-cube graphs are all connected.

\begin{lemma}
If $G$ is a graph and $x$ is a vertex in $G$ such that, for every vertex $y$ in $G$, there is a path from $x$ to $y$, then $G$ is connected.
\end{lemma}

\begin{proof}
Suppose such a vertex $x$ exsts. Let $u$ and $v$ be vetices of $G$. By hopthesis there is a path from $u$ to $x$ and a path from $x$ to $v$, so there is a path from $u$ to $v$ by lemma~\ref{connectedPaths}.
\end{proof}

A {\bf component} of a graph $G$ is a maximal connected subgraph of $G$. That is, a connected subgraph of $G$ that is not contained as a subgraph in any larger connected subgraph of $G$.

Often, to understand a graph in some way it will suffice to understand the graph's components. For example: $G$ is bipartite if and only if each of its components are bipartite.

If $(A,B)$ is a partition of the vertex set of a graph $G$, then the {\bf cut} of $G$ induced by $(A,B)$ is the set of edges of $G$ with one end in $A$ and one end in $B$.

\begin{lemma}
A graph $G$ is diconnected if and only if there exists a partition $(A,B)$ of its vertex set such that $A,B \neq \varnothing$ and $(A,B)$ induces an empty cut.
\end{lemma}

\begin{theorem}[Chuatal '72]
If $G$ is a graph on $n$ vertices with degrees $d_1 \leq d_2 \leq \cdots \leq d_n$, then if ($d_i > i$ or $d_{n-1} \geq n-i$) for all $i < \half n$, then $G$ is Hamiltonian.
\end{theorem}

A graph is {\bf k-connected} if there are $k$ `internally disjoint' paths between any pair of its vertices. Equivalently, for any $k-1$ vertices, removing them leaves a connected graph.

It was postulated that ``If $G$ is a 3-connected graph that can be drawn in the plane without edges crossing, then $G$ is Hamiltonian.'' This, though, we proven wrong by the Tutte Graph; instead, we postulate that every 4-connected graph that can be drawn in the plane without crossings is Hamiltonian.

% EULER TOURs

\begin{theorem}
Every connected graph in which every vertex has even degree is Eulerran.
\end{theorem}

\begin{proof}
If the edge set is empty, the theorem is obviously true. Suppose the theorem holds for all graphs on $< m$ edges. Let $G$ be a connected graph with $m$ edges and all even degrees. By the propositions, $G$ contains a cycle. Let $F$ be the edge set of a largest-possible closed walk of $G$ that doesn't repeat edges. If $F=E$, we're done, Otherwise, $(V,E-F)$ is a graph with even degrees and fewer edges than $G$, so by the IH each of its components has a Euler tour. Combining such a Euler tour with $F$ gives a longer closed walk with no repeated edges, a contradiction.
\end{proof}

An edge $e$ of a graph $G$ is a {\bf bridge} of $G$ ig $G-e$ has more components than $G$.

\begin{lemma}
If $E=xy$ is a bridge of $G$, then $x$ and $y$ are in different components of $G-e$.
\end{lemma}

\begin{lemma}
If $e$ is a bridge of $G$, then $G-e$ has exactly one more componenet than $G$.
\end{lemma}

\begin{proof}
In the case where $G$ is connected: $G-e$ has $\geq 2$ components. Suppose for a contradiction that $G-e$ has $\geq 3$ componenets; let $C_0, C_1, C_2$ be distinct components of $G-e$. At least one of these components contains neither end of $e$, and is therefore a component of $G$. Since it does not contain $e$, it is not all of $G$; thus $G$ is diconected.
\end{proof}

A graph is $k${\bf -edge-connected} if deleting any $k-1$ edges leaves a connected graph.

\begin{theorem}[Menger's Theorem (Edge version)]
If $G$ is a $k$-edge-connected graph, then there are $k$ edge-disjoint paths between every pair of vertices in $G$.
\end{theorem}

\begin{theorem}
Let $G$ be a cnnected graph with no bridge. For any pair of vertices $x,y$ in $G$, there are two edge-disjoint paths of $G$ btween $x$ and $y$.
\end{theorem}

\subsection{Trees}
A {\bf tree} is a connected graph with no cycle (acyclic). In a graph such as this, each edge is a bridge.

\begin{lemma}
Every edge of a tree is a bridge.
\end{lemma}

\begin{proof}
We proved earlier than an edge $e$ is a bridge if and only if $e$ is contained in no cycle. Therefore every edge of a tree is a bridge.
\end{proof}

\begin{lemma}
If $x,y$ are vertices of a tree $T$, then there is a unique path of $T$ from $x$ to $y$.
\end{lemma}

\begin{proof}
Let $P,Q$ be different paths from $x$ to $y$. $P$ and $Q$ `diverge' at some point and $Q$ `returns' to a vertex in $P$ at some point thereafter; this gives a cycle, so $T$ is not a tree. Contradiction!
\end{proof}

\begin{proof}[Alternative Proof]
Let $A$ be the set of edges of $T$ so that $x,y$ are in different components after the edge is removed. Let $B$ be the set of edges such that $x,y$ are in the same component once the edge is removed.

Clearly every path from $x$ to $y$ users every edge in $A$ and none in $B$. This determines a unique path.
\end{proof}

\begin{lemma}
Every tree on $\geq 2$ vertices has a leaf (vertex of degree 1).
\end{lemma}

\begin{proof}
We proved earlier that every graph with min degree $\geq 2$ has a cycle. By contraposition, every acyclic graph has a vertex of degree less than two. Since trees on $\geq 2$ vertices have no vertices of degree 0, this implies they all have a leaf.
\end{proof}

\begin{lemma}
Every tree on $\geq 2$ vertices has $\geq 2$ leaves.
\end{lemma}

\begin{proof}
Let $v_0, v_1, v_2, \dots v_k$ be a longest path of $T$. By maximality of the path, neither $v_0$ nor $v_k$ has a neighbour outside the path. By acyclicity, neither has a neighbour inside the path except for $v_1, v_{k-1}$ respectively. So $v_0, v_k$ have degree 1.
\end{proof}

\begin{lemma}
Each tree on $n \geq 1$ vertices has exactly $n-1$ edges.
\end{lemma}

\begin{proof}
This is trivial for $n=1$. Fix $n>1$ and suppose inductively that the result holds for all positive integers less than $n$. Let $T$ be a tree on $n$ vertices and $e$ be an edge of $T$.

We know that $e$ is a bridge, so $T-e$ has exactly two componenets $T_1, T_2$; each is acyclic and is thus a tree. If $|V(T_1)| = n$, then $n_1 + n_2 = n$. By the induction hypothesis, each $T_i$ has $n_i - 1$ edges, so $T$ has $(n_1 - 1) + (n_2 - 1) + 1 = n-1$ edges.
\end{proof}

\begin{lemma}
Each tree $T$ on $n \geq 2$ vertices has $\geq 2$ leaves.
\end{lemma}

\begin{proof}
By the handshake theorem, $2(n-1) = 2|E(T)| = \displaystyle\sum_{v\in V(T)} \deg(v)$.

So
\begin{align*}
-2 &= \sum_{v\in V(T)} \deg(v) - 2n\
-2 &= \sum_{v\in V(T)} (\deg(v) - 2)
\end{align*}

Since $\deg(v) \geq 1$ for all $v$ which implies $\deg(v) - 2 \geq 0$ for all vertices of degree $\geq 2$, it follows that there are at least 2 vertices of degree 1 (i.e.\ there are two leaves).
\end{proof}

Note that given the above proof, we can prove that if a graph has exactly two leaves, the other vertices must all have degree two\dots thus we see that this graph must be a path.

\subsubsection{Spanning Trees}
A {\bf spanning tree} for a graph $G$ is a spanning subgraph $T$ of $G$ ($V(T) = V(G)$) that is a tree.

\begin{lemma}
A graph $G$ has a spanning tree if and only if $G$ is connected.
\end{lemma}

\begin{proof}
Suppose $G$ has a spanning tree $T$. By connectedness of $T$, there is a path in $T$ between two vertices of $T$ which is a path in $G$; thus $G$ is connected. Conversely, suppose that $G$ is connected.

Let $H$ be a minimal connected spanning subgraph of $G$. To show that $H$ is a spanning tree, we need to argue it is acyclic. By minimality, every edge is a brdige. But then $H$ is acyclic, so it is a spanning tree.
\end{proof}

\begin{lemma}
Corrolary: Every connected graph on $n$ vertices has $\geq n-1$ edges.
\end{lemma}

\begin{proof}
The graph has a spanning tree, which has $n-1$ edges.
\end{proof}

\begin{lemma}
Corrolary: Every connected graph on $n$ vertices and $n-1$ edges is a tree.
\end{lemma}

\begin{proof}
The graph has a spanning tree using all the edges.
\end{proof}

\begin{theorem}
\label{bipartiteTrees}
Every tree is bipartite.
\end{theorem}

\begin{proof}
Suppose the statute holds for all trees on $<n$ vertices (where $n\geq 2$ is an integer; note that $n=2$ is a simple base case). Let $T$ be a tree on $n$ vertices and $e=uv$ be an edge of $T$ so that $v$ is a leaf. By the inductive hypothesis, $T-v$ is bipartite with bipartition $(A^\prime, B^\prime)$ where $u \in A^\prime$. Now, $(A^\prime, B^\prime \cup \{v\})$ is a bipartition of $T$.
\end{proof}

\begin{lemma}
\label{bipartiteWalkLengths}
If $G$ is a bipartite graph and $u,v \in V(G)$, then
\begin{itemize}
\item if $u,v$ are in the same part of a biparititon, then every walk from $u$ to $v$ has an even length
\item if $u,v$ are in different parts, then every walk from $u$ to $v$ has odd length
\end{itemize}
\end{lemma}

\begin{proof}
Obvious.
\end{proof}

\begin{lemma}
If $G$ is a graph with no odd cycles, then $G$ is bipartite.
\end{lemma}

\begin{proof}
Let $T$ be a spanning tree of $G$ (we may assume that $G$ is connected; otherwise, we may apply this proof to each component). Let $(A,B)$ be a bipartition of $T$ (by theorem~\ref{bipartiteTrees}). By lemma~\ref{bipartiteWalkLengths} and connectedness of $T$, any two vertices in the same part of this bipartition have an even path between them.

Therefore, every edge of $G$ between vertices of $G$ in the same part of $(A,B)$ is in an odd cycle of $G$. Since $G$ has no odd cycles, there are no such adges. So $(A,B)$ is a bipartition of $G$, and $G$ is thus bipartite.
\end{proof}

{\bf Problem:} Given a graph $G$ and a real number $w(e)$ assigned to each edge $e$ (its weight), find a spanning tree of $G$ of minimum total weight.

{\bf Algorithm:} an algorithm (Prim's algorithm) for solving this problem is as follows:
\begin{enumerate}
\item Let $T = (\{v\},\varnothing)$, where $v \in V(G)$ is arbitrary
\item While $T$ is not a spanning tree (i.e.\ $|E(T)| < V(T) -1$)
\begin{enumerate}
\item Let $f=uv$ be a minimum weight edge such that $u \in V(T), v \notin V(T)$ ($f$ is in the cut of $G$ induced by $V(T)$)
\item Add $f$ abd $v$ to $T$
\end{enumerate}
\end{enumerate}

\begin{theorem}
Prim's algorithm outputs a minimum weight spanning tree.
\end{theorem}

\end{document}
